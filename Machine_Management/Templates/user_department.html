<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>User&Department</title>


    {% load static %}
    <!-- Font Awesome -->
<!--    <link rel="stylesheet" type="text/css" href="{% static 'iconfont/all.css' %}">-->
    <!-- icon -->
    <link rel="stylesheet" type="text/css" href="{% static 'iconfont/material-icons.css' %}">
    <!-- Fonts -->
    <link rel="stylesheet" type="text/css" href="{% static 'fonts/fonts.css' %}">
    <!-- Multiselect -->
    <link href="{% static 'style/multi-select.css' %}" media="screen" rel="stylesheet" type="text/css">

    <!--  Popper  -->
    <script src="{% static 'javascript/popper-1.16.0.min.js' %}"></script>
    <!-- Jquery   -->
    <script src="{% static 'javascript/jquery-3.5.1.min.js' %}"></script>
    <!-- Bootstrap 4.5.3 -->
    <link rel="stylesheet" type="text/css" href="{% static 'style/bootstrap.min.css' %}">
    <script src="{% static 'javascript/bootstrap.min.js' %}"></script>
    <!-- DataTable   -->
    <link rel="stylesheet" type="text/css" href="{% static 'style/jquery.dataTables-1.10.19.min.css' %}">
    <script src="{% static 'javascript/jquery.dataTables.min.js' %}"></script>
    <!-- Moment   -->
    <script src="{% static 'javascript/moment-2.29.0.min.js' %}"></script>
    <!-- Input Date Format  DD/MM/YYYY -->
    <link rel="stylesheet" type="text/css" href="{% static 'style/input_date.css' %}">
    <!-- Create Avatar -->
    <script src="{% static 'javascript/avatar.js' %}"></script>
    <!-- Container Form -->
    <link rel="stylesheet" type="text/css" href="{% static 'style/container-fluid.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'style/department.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'style/form-group.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'style/switch.css' %}">
    <!-- bootstrap-select -->
    <script src="{% static 'javascript/bootstrap-select.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'style/bootstrap-select.min.css' %}">



</head>
<body>

<div class="container-fluid">
    <nav class="navbar navbar-expand-md navbar-light" style="background-color: #f5f5f5;">
        <a href="{% url 'home' %}" class="navbar-brand">
            <img src="/static/img/farmhouse_logo copy.gif" height="65" alt="CoolBrand">
        </a>
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
            <div class="navbar-nav">
                <a href="#" class="nav-item nav-link active"><b>Department Management</b></a>
            </div>
            <form method="POST" action="{% url 'signin' %}">
                {% csrf_token %}
                <ul class="nav navbar-nav ml-auto">
                    <a href="#" class="nav-item nav-link" style="color:#B22222">{{User_login.username}}</a>
                    <button type="submit" class="btn btn-outline-secondary" name="signout" >Sign out</button>
                </ul>
            </form>
        </div>
    </nav>
</div>
<div class="container-fluid">
    <div class="table-responsive">
        {% for message in messages %}
        <div class="alert {{ message.tags }} ">
            <span class="closebtn" onclick="this.parentElement.style.display='none';" style="color: #454545; font-size: 36px;">&times;</span>
            {{ message }}
        </div>
        {% endfor %}
        <div class="table-wrapper">
            <form method="POST">
            <div class="table-title">
                <div class="row">
                    <div class="col-sm-5">
                        <h2>Department <b>Management</b></h2>
                    </div>
                    
                    <div class="col-sm-7">
                        <a href="#newDepartment" class="btn btn-secondary" data-toggle="modal"><i class="material-icons">&#xE147;</i> <span>New Department</span></a>
                    </div>
                </div>
            </div>

            <div class="department-tab" style="margin-bottom: 10px;">
                <ul class="nav nav-tabs nav-fill" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="departmants-tab" data-toggle="tab" href="#departmants-body" role="tab" aria-controls="departmants-body" aria-selected="true">Departmants</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="members-tab" data-toggle="tab" href="#members-body" role="tab" aria-controls="members-body" aria-selected="false">Members</a>
                    </li>
                </ul>
            </div>
            <div class="tab-content" id="TabContent">
                <div class="tab-pane fade show active" id="departmants-body" role="tabpanel" aria-labelledby="departmants-tab">
                    <table class="table table-striped table-hover" id="myTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th style="width:20%">Department ID</th>
                                <th style="width:30%">Department Name</th>
                                <th style="width:40% ">Members</th>
                                <th style="width:10%"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td></td>
                                <td></td>
                                <td>
                                    <ul class="avatars">
                                        <li>
                                            <img class="avatar-list" avatar="อากาโสะ เอจิ" data-toggle="tooltip" title="อากาโสะ เอจิ">
                                        <li>
                                            <img class="avatar-list" avatar="เคย์ตะ มาจิดะ" data-toggle="tooltip" title="เคย์ตะ มาจิดะ">
                                        </li>
                                        <li>
                                            <a href="#members" data-toggle="modal"><span class="more-member">+2</span></a>
                                        </li>
                                    </ul>
                                </td>
                                <td>
                                    <a href="#editDepartment" class="settings" title="Settings" data-toggle="modal" ><i class="material-icons">&#xE8B8;</i></a>
                                </td>
                            </tr>
                            <!-- Modal Members -->
                            <div id="members" class="modal fade" tabindex="-1">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Members</h5>
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-6">
                                                    <div class="member-detial">
                                                        <img class="lettet-avatar" avatar="อากาโสะ เอจิ">
                                                        <div class="member-detial-body">
                                                            <h6 class="mb-0 H6-filter-by-text" data-filter-by="text">Claire Connors</h6>
                                                            <span data-filter-by="text" class="text-body SPAN-filter-by-text">Administrator</span>
                                                        </div>
                                                    </div>
                                                    <div class="member-detial">
                                                        <img class="lettet-avatar" avatar="เคย์ตะ มาจิดะ">
                                                        <div class="member-detial-body">
                                                            <h6 class="mb-0 H6-filter-by-text" data-filter-by="text">Claire Connors</h6>
                                                            <span data-filter-by="text" class="text-body SPAN-filter-by-text">Administrator</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="member-detial">
                                                        <img class="lettet-avatar" avatar="Akaso Eiji">
                                                        <div class="member-detial-body">
                                                            <h6 class="mb-0 H6-filter-by-text" data-filter-by="text">Claire Connors</h6>
                                                            <span data-filter-by="text" class="text-body SPAN-filter-by-text">Administrator</span>
                                                        </div>
                                                    </div>
                                                    <div class="member-detial">
                                                        <img class="lettet-avatar" avatar="Keita Machida">
                                                        <div class="member-detial-body">
                                                            <h6 class="mb-0 H6-filter-by-text" data-filter-by="text">Claire Connors</h6>
                                                            <span data-filter-by="text" class="text-body SPAN-filter-by-text">Administrator</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane fade" id="members-body" role="tabpanel" aria-labelledby="members-tab">
                    <table class="table table-striped table-hover" id="myTable1">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Username</th>
                                <th>Full name</th>
                                <th>Role</th>
                                <th>Organize</th>
                                <th>Department</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td><img src="/static/img/avatar.svg" class="avatar" alt="Avatar">001016</td>
                                <td>{{user.firstname}} {{user.lastname}}</td>
                                <td>{{user.role}}</td>
                                <td>{{user.org}}</td>
                                <td>{{user.create_date}}</td>
                                <td>
                                    <a href="#edit" class="settings" title="Settings" data-toggle="modal"><i class="material-icons">&#xE8B8;</i></a>
                                    <!-- <a href="#delete{{user.username}}" class="delete" title="Delete" data-toggle="modal"><i class="material-icons">&#xE5C9;</i></a> -->
                                </td>
                            </tr>
                            
                        </tbody>
                    </table>
                </div>
                <!-- Modal New Department -->
                <div id="newDepartment" class="modal fade" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-content">
                                <form method="post">
                                    {% csrf_token %}
                                    <div class="modal-header">
                                        <h5 class="modal-title">New Department</h5>
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <h6 style="font-size: 17px; color: #212529; margin-top: 0.75rem; margin-bottom: 0.75rem;">Details</h6>
                                        <div class="row new-department-form">
                                            <label class="col-3">Code</label>
                                            <input class="form-control col" type="text" placeholder="Department Code" name="department-code">
                                        </div>
                                        <div class="row new-department-form">
                                            <label class="col-3">Name</label>
                                            <input class="form-control col" type="text" placeholder="Department Name" name="department-name">
                                        </div>    
                                        <hr>
                                        <h6 style="font-size: 17px; color: #212529; margin-bottom: 0.75rem;">Members</h6>
                                        <div class="row new-department-form">
                                            <label class="col-3">Organize</label>
                                            <select class="selectpicker select-org" data-width="75%" multiple data-actions-box="true" onchange="load_userInOrg(this)">
                                                {% for org in orgs %}
                                                <option value="{{ org.org_id }}">{{ org.org_name }}</option>
                                                {% endfor %}
                                            </select>

                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary">Create Department</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal Edit Department's member -->
                <div id="editDepartment" class="modal fade" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Edit Department's member</h5>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                            <div class="modal-body">
                                <button type="button" class="btn btn-info add-new" style="float: right;"><i class="fas fa-user-plus"></i> Add New Member</button>
                                <table class="table edit-user table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Department</th>
                                            <th>Phone</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>John Doe</td>
                                            <td>Administration</td>
                                            <td>(171) 555-2222</td>
                                            <td>
                                                <a class="add" title="Add" data-toggle="tooltip"><i class="material-icons">&#xE03B;</i></a>
                                                <a class="edit" title="Edit" data-toggle="tooltip"><i class="material-icons">&#xE254;</i></a>
                                                <a class="delete" title="Delete" data-toggle="tooltip"><i class="material-icons">&#xE872;</i></a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Peter Parker</td>
                                            <td>Customer Service</td>
                                            <td>(313) 555-5735</td>
                                            <td>
                                                <a class="add" title="Add" data-toggle="tooltip"><i class="material-icons">&#xE03B;</i></a>
                                                <a class="edit" title="Edit" data-toggle="tooltip"><i class="material-icons">&#xE254;</i></a>
                                                <a class="delete" title="Delete" data-toggle="tooltip"><i class="material-icons">&#xE872;</i></a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Fran Wilson</td>
                                            <td>Human Resources</td>
                                            <td>(503) 555-9931</td>
                                            <td>
                                                <a class="add" title="Add" data-toggle="tooltip"><i class="material-icons">&#xE03B;</i></a>
                                                <a class="edit" title="Edit" data-toggle="tooltip"><i class="material-icons">&#xE254;</i></a>
                                                <a class="delete" title="Delete" data-toggle="tooltip"><i class="material-icons">&#xE872;</i></a>
                                            </td>
                                        </tr>      
                                    </tbody>
                                </table>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal Edit User's permission -->
                <div id="edit" class="modal fade" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Permissions</h5>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div>
                                    <table class="table table-striped permission-table">
                                        <thead>
                                          <tr>
                                            <th style="width:20%"></th>
                                            <th style="width:10%"><center>Inform</center></th>
                                            <th style="width:10%"><center>Inspect</center></th>
                                            <th style="width:10%"><center>Approve</center></th>
                                            <th style="width:10%"><center>Recieve</center></th>
                                            <th style="width:10%"><center>Assign</center></th>
                                            <th style="width:10%"><center>Report</center></th>
                                            <th style="width:10%"><center>Verify</center></th>
                                            <th style="width:10%"><center>Close</center></th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          <tr>
                                            <td><b>Departmant XXX</b></td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td><b>Departmant YYY</b></td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                            <td><center>
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span class="checkbox-custom circular"></span>
                                                </label>
                                                </center>
                                            </td>
                                          </tr>

                                        </tbody>
                                      </table>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary">Save changes</button>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </form>
        </div>
    </div>

</div>
<script src="{% static 'javascript/avatar.js' %}" type="text/javascript"></script>
<script>
    $(document).ready( function () {
        $('#myTable').DataTable();
        $('#myTable1').DataTable();
    } );
</script>

<script>
    $(document).ready(function(){
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
<script src="{% static 'javascript/input_date.js'%}"></script>
<script>
    function load_userInOrg(element) {
        var selectedItem = $(element).val();
        console.log(selectedItem);
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: "{% url 'load_userInOrg' %}",
            data: {
                "csrfmiddlewaretoken" : $(element).siblings("input[name='csrfmiddlewaretoken']").val(),
                'list_org': selectedItem
            },
            success : function (data) {
                    if (data) {
                        console.log(data);
                    }
                }
        });
    };
</script>
</body>
</html>
