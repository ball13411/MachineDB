{% extends 'home/layout_home.html' %}
{% load static %}
<!-- Font Awesome -->
<link rel="stylesheet" type="text/css" href="{% static 'iconfont/all.css' %}">
<!-- Jquery   -->
<script src="{% static 'javascript/jquery-3.5.1.min.js' %}"></script>
<!-- Create Avatar -->
<script src="{% static 'javascript/avatar.js' %}"></script>

{% block content %}
<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
  <ol class="carousel-indicators">
    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
  </ol>
</div>
<!-- Style -->
<link rel="stylesheet" type="text/css" href="{% static 'style/home.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'style/calendar.css' %}">
<!-- Content -->
<div class="home-greeting">
    <div class="page-header row no-gutters py-4">
        <div class="col-12 col-sm-4 text-sm-left mb-0">
            <span>Hi {{User_login.firstname}}</span><br>
            </h3><h3 id="Greetings"></h3>
            <span id="today-date"></span>
        </div>
    </div>
</div>
<div class="container home-content">
    <div class="row">
        <div class="col-12 col-xl-4 d-none d-xl-flex flex-column" style="padding-left: 0px;">
            <div class="card" style="margin-bottom: 24px;">
                <div class="card-body py-4">
                    <div class="maintenance-notify">
                        <div class="maintenance-notify-body">
                            <h3 class="mb-2">{{repair_inform_incomplete.count}}</h3>
                            <p class="mb-2">ใบแจ้งซ่อมเครื่องจักร</p>
                            <div class="mb-0">
                                <span class="badge request-badge">กำลังดำเนินการแจ้งซ่อม</span>
                            </div>
                        </div>
                        <div class="d-inline-block ml-3">
                            <div class="stat">
                                <a href="{% url 'repair_notice' %}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-file-earmark-arrow-down" viewBox="0 0 16 16">
                                    <path d="M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z"/>
                                    <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"/>
                                </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-body py-4">
                    <div class="maintenance-notify">
                        <div class="maintenance-notify-body">
                            <h3 class="mb-2">{{mtn_report_incomplete.count}}</h3>
                            <p class="mb-2">รายการ</p>
                            <div class="mb-0">
                                <span class="badge pending-badge">กำลังดำเนินการซ่อมบำรุง</span>
                            </div>
                        </div>
                        <div class="d-inline-block ml-3">
                            <div class="stat">
                                <a href="{% url 'maintenance_report' %}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-tools" viewBox="0 0 16 16">
                                    <path d="M1 0L0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.356 3.356a1 1 0 0 0 1.414 0l1.586-1.586a1 1 0 0 0 0-1.414l-3.356-3.356a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0zm9.646 10.646a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708zM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11z"/>
                                </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12 col-lg-6 col-xl-4 d-flex">
            <div class="card flex-fill w-100 daily-tasks">
                <div class="card-header" style="background-color: #fff; padding-top: 1.25rem;">
                    <div class="d-flex justify-content-between align-items-center">
                        <div><span class="h4"><b>Daily tasks</b></span></div>
                        <div><p class="task-count">({{today_request_tasks.count|add:today_maintenance_tasks.count}})</p></div>
                    </div>
                </div>
                <div class="card-body scrollable-y" style="max-height: 277px;">
                    {% for request in today_request_tasks %}
                    <div class="media">
                        <div class="task-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-arrow-down" viewBox="0 0 16 16">
                                <path d="M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z"/>
                                <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"/>
                            </svg>
                        </div>
                        <div class="media-body">
                            <strong>{{request.repairer_user.firstname}} {{request.repairer_user.lastname}}</strong> แจ้งซ่อม<strong>{{request.machine.machine_name}}</strong> {{request.machine.line}}
                            {% if request.problem_report %}
                                เนื่องจาก{{request.problem_report}}
                            {% endif %}
                        </div>
                    </div>
                    <hr>
                    {% endfor %}
                    {% for maintenance in today_maintenance_tasks %}
                    {% if maintenance.job_status == 'รอการมอบหมาย' or maintenance.job_status == 'รอการมอบหมายงาน' %}
                    <div class="media">
                        <div class="task-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-plus-fill" viewBox="0 0 16 16">
                                <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                <path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z"/>
                            </svg>
                        </div>
                        <div class="media-body">
                            รอการมอบหมายงานซ่อม<strong>{{maintenance.job_mch_sp.spare_part}}</strong> {{maintenance.job_mch_sp.machine.machine_name}} {{maintenance.job_mch_sp.machine.line}}
                        </div>
                    </div>
                    <hr>
                    {% elif maintenance.job_status == 'รอการดำเนินงาน' %}
                    <div class="media">
                        <div class="task-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-tools" viewBox="0 0 16 16">
                                <path d="M1 0L0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.356 3.356a1 1 0 0 0 1.414 0l1.586-1.586a1 1 0 0 0 0-1.414l-3.356-3.356a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0zm9.646 10.646a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708zM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11z"/>
                            </svg>
                        </div>
                        <div class="media-body">
                            <strong>{{maintenance.job_response_user.firstname}} {{maintenance.job_response_user.lastname}}</strong> กำลังดำเนินการซ่อม{{maintenance.job_mch_sp.machine.machine_name}} {{maintenance.job_mch_sp.machine.line}}
                        </div>
                    </div>
                    <hr>
                    {% elif maintenance.job_status == 'รอการอนุมัติงาน' %}
                    <div class="media">
                        <div class="task-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-arrow-up" viewBox="0 0 16 16">
                                <path d="M8.5 11.5a.5.5 0 0 1-1 0V7.707L6.354 8.854a.5.5 0 1 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 7.707V11.5z"/>
                                <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"/>
                            </svg>
                        </div>
                        <div class="media-body">
                            รออนุมัติผลการซ่อม<strong>{{maintenance.job_mch_sp.spare_part}}</strong> {{maintenance.job_mch_sp.machine.machine_name}} {{maintenance.job_mch_sp.machine.line}}
                        </div>
                    </div>
                    <hr>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="col-lg-6 col-xl-4 d-flex" style="justify-content:flex-end;">
            <div class="card card-calendar">
                <!-- Calendar -->
                <div id="calendar"></div>
            </div>
        </div>
    </div>
</div>
<div class="machine-data-header">

    <div class="page-header row no-gutters py-4">
        <div class="col-12 col-sm-4 text-sm-left mb-0">
        <span class="text-uppercase page-subtitle">Overview</span>
        <h3 class="page-title">Production Line Data</h3>
        </div>
    </div>
</div>
<div class="machine-overview-content">
    <div class="row">
        <div class="col-md-12">
            {% for production_line in line_of_user %}
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="card menu-card mb-4 text-center hover-bg-secondary">
                    <div class="card-body p-5">
                        <svg width="4em" height="4em" viewBox="0 0 16 16" class="bi bi-house text-color" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                          <path fill-rule="evenodd" d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
                          <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
                        </svg>
                        <h4 class="card-title">{{production_line}}</h4>
                        <a href="{% url 'machine_data_line' production_line.pk %}" class="stretched-link"></a>
                    </div>
                </div>
            </div>
            {% endfor %}

        </div>
    </div>
</div>
<script src="{% static 'javascript/greeting.js' %}" type="text/javascript"></script>

{% endblock %}
